<view class="detail-container" wx:if="{{message}}">
    <!-- æ¶ˆæ¯å¤´éƒ¨ -->
    <view class="message-header">
        <view class="type-info">
            <text class="type-tag type-{{message.message_type}}">{{message.vmessage_type}}</text>
        </view>
        <view class="time-info">{{message.vtimestamp}}</view>
    </view>

    <!-- æ¶ˆæ¯æ ‡é¢˜ -->
    <view class="message-title" wx:if="{{message.title}}">{{message.title}}</view>

    <!-- æ¶ˆæ¯å†…å®¹ -->
    <view class="message-content">
        <view>{{message.content}}</view>
        <view wx:if="{{hasimage}}">
            <t-grid column="{{4}}">
                <t-grid-item wx:for="{{images}}" wx:for-item="item" wx:key="id">
                    <t-image src='{{item.src}}' width="72" height="72" bind:tap="showImg" data-id="{{item.id}}"></t-image>
                </t-grid-item>
            </t-grid>
        </view>
    </view>
    <t-image-viewer background-color="white" default-visible="{{false}}" showIndex="{{true}}" visible="{{showDetail}}" images="{{srcs}}" bind:change="onChange" bind:close="onClose" initial-index="{{index}}"></t-image-viewer>

    <!-- å…ƒä¿¡æ¯ -->
    <view class="meta-info" wx:if="{{message.location || message.contact_info}}">
        <view class="meta-item" wx:if="{{message.location}}">
            <text class="meta-label">ğŸ“ ä½ç½®ï¼š</text>
            <text class="meta-value">{{message.location}}</text>
        </view>
        <view class="meta-item" wx:if="{{message.contact_info}}">
            <text class="meta-label">ğŸ“ è”ç³»ï¼š</text>
            <text class="meta-value selectable" user-select="{{true}}">{{message.contact_info}}</text>
        </view>
    </view>

    <!-- æ ‡ç­¾ -->
    <view class="tags-section" wx:if="{{message.tags}}">
        <text class="section-title">æ ‡ç­¾</text>
        <view class="tags">
            <text class="tag" wx:for="{{message.vtags}}" wx:key="*this">{{item}}</text>
        </view>
    </view>

    <!-- ç»Ÿè®¡ä¿¡æ¯ -->
    <view class="stats-section">
        <view class="stat-item">
            <text class="stat-label">æµè§ˆæ¬¡æ•°</text>
            <text class="stat-value">{{message.view_count}}</text>
        </view>
        <view class="stat-item">
            <text class="stat-label">ç‚¹èµæ¬¡æ•°</text>
            <text class="stat-value">{{message.like_count}}</text>
        </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-section">
        <button class="action-btn like-btn" bindtap="onLike" disabled="{{liking}}">
            ğŸ‘ {{liking ? 'ç‚¹èµä¸­...' : 'ç‚¹èµ'}}
        </button>
        <button class="action-btn contact-btn" wx:if="{{message.contact_info}}" bindtap="copyContact">
            ğŸ“‹ å¤åˆ¶è”ç³»æ–¹å¼
        </button>
    </view>
    <text style="font-size: 36rpx;font-weight: bold;">è®¨è®ºåŒº</text>
    <!-- å‘é€æ  -->
    <view class="send-container">
        <input class="send-input" placeholder="å‘é€å†…å®¹..." bindinput="onSendInput" value="{{sendMessage}}" />
        <button class="send-btn" bindtap="onSend" size="mini">å‘é€</button>
    </view>
    <view class="message-list">
        <view wx:for="{{messages}}" wx:key="id" class="message-item" data-id="{{item.id}}">
            <text>{{item.content}}</text>
        </view>
    </view>
</view>
<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
</view>

<!-- é”™è¯¯çŠ¶æ€ -->
<view class="error" wx:if="{{error}}">
    <text>{{error}}</text>
    <button class="retry-btn" bindtap="loadMessage" size="mini">é‡è¯•</button>
</view>