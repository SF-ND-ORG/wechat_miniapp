<scroll-view class="ui-page wall-page" scroll-y="true" enable-back-to-top="true">
	<view class="ui-card wall-hero">
		<view class="wall-hero__head">
			<view>
				<text class="ui-title">ç•™è¨€æ¿</text>
			</view>
			<view class="wall-hero__actions">
				<button wx:if="{{isAdmin}}" class="wall-btn wall-btn--ghost" bindtap="goToAdmin">ç®¡ç†é¢æ¿</button>
				<button class="wall-btn wall-btn--primary" bindtap="goToPost">å‘å¸ƒæ¶ˆæ¯</button>
			</view>
		</view>
	</view>

	<view class="ui-card wall-toolbar">
		<view class="wall-tabs">
			<text class="wall-tab {{currentType === 'all' ? 'is-active' : ''}}" bindtap="onTypeChange" data-type="all">å…¨éƒ¨</text>
			<text class="wall-tab {{currentType === 'general' ? 'is-active' : ''}}" bindtap="onTypeChange" data-type="general">æ™®é€š</text>
			<text class="wall-tab {{currentType === 'lost_and_found' ? 'is-active' : ''}}" bindtap="onTypeChange" data-type="lost_and_found">å¤±ç‰©æ‹›é¢†</text>
			<text class="wall-tab {{currentType === 'help' ? 'is-active' : ''}}" bindtap="onTypeChange" data-type="help">æ±‚åŠ©</text>
		</view>
		<view class="wall-search">
			<input class="wall-search__input" placeholder="æœç´¢å†…å®¹ã€åœ°ç‚¹æˆ–æ ‡ç­¾" bindinput="onSearchInput" value="{{searchKeyword}}" />
			<button class="wall-search__btn" bindtap="onSearch">æœç´¢</button>
		</view>
	</view>

	<view wx:if="{{loading && messages.length === 0}}" class="ui-card ui-card--compact wall-state">æ­£åœ¨åŠ è½½å¢™é¢æ¶ˆæ¯...</view>

	<block wx:if="{{messages.length > 0}}">
		<view class="wall-feed">
			<view wx:for="{{messages}}" wx:key="id" class="wall-card ui-card ui-card--quiet" bindtap="goToDetail" data-id="{{item.id}}">
				<view class="wall-card__header">
					<view class="wall-card__author">
						<image class="wall-card__avatar" src="{{item.author_avatar}}" mode="aspectFill"></image>
						<view class="wall-card__author-info">
							<text class="wall-card__author-name">{{item.vauthor}}</text>
							<text class="wall-card__time">{{item.vtimestamp}}</text>
						</view>
					</view>
					<text class="wall-card__tag type-{{item.message_type}}">{{item.vmessage_type}}</text>
				</view>
				<view class="wall-card__title" wx:if="{{item.title}}">{{item.title}}</view>
				<view class="wall-card__content">{{item.content}}</view>
				<view wx:if="{{item.hasimage}}" class="wall-card__media">
					<t-grid column="{{4}}">
						<t-grid-item wx:for="{{item.images}}" wx:for-item="image" wx:key="*this">
							<t-image src="{{image}}" width="156" height="156"></t-image>
						</t-grid-item>
					</t-grid>
				</view>
				<view class="wall-card__meta" wx:if="{{item.location || item.contact_info}}">
					<text wx:if="{{item.location}}" class="wall-card__meta-item">ğŸ“ {{item.location}}</text>
					<text wx:if="{{item.contact_info}}" class="wall-card__meta-item">ğŸ“ {{item.contact_info}}</text>
				</view>
				<view class="wall-card__footer">
					<view class="wall-card__stats">
						<text class="wall-card__stat">ğŸ‘€ {{item.view_count}}</text>
						<text class="wall-card__stat">ğŸ‘ {{item.like_count}}</text>
					</view>
					<view class="wall-card__tags" wx:if="{{item.tags}}">
						<text class="wall-card__chip" wx:for="{{item.vtags}}" wx:key="*this">{{item}}</text>
					</view>
				</view>
			</view>
		</view>
	</block>

	<view wx:elif="{{!loading}}" class="ui-empty">æš‚æ— æ¶ˆæ¯ï¼Œç‡å…ˆå‘å¸ƒä¸€æ¡åˆ†äº«å§</view>
</scroll-view>